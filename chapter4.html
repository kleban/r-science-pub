<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Розділ 4 Збір та читання інформації з різноманітних джерел: файли, веб-сторінки, бази R | Підготовка, обробка та ефективне використання даних для наукових досліджень</title>
  <meta name="description" content="Курс вступ до програмування в R, Проект DataClass" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Розділ 4 Збір та читання інформації з різноманітних джерел: файли, веб-сторінки, бази R | Підготовка, обробка та ефективне використання даних для наукових досліджень" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/images/cover.png" />
  <meta property="og:description" content="Курс вступ до програмування в R, Проект DataClass" />
  <meta name="github-repo" content="kleban/r-science-pub" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Розділ 4 Збір та читання інформації з різноманітних джерел: файли, веб-сторінки, бази R | Підготовка, обробка та ефективне використання даних для наукових досліджень" />
  
  <meta name="twitter:description" content="Курс вступ до програмування в R, Проект DataClass" />
  <meta name="twitter:image" content="/images/cover.png" />

<meta name="author" content="Юрій Клебан" />


<meta name="date" content="2021-07-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="chapter3.html"/>
<link rel="next" href="chapter5.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SQNMJRY3XS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SQNMJRY3XS');
</script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a  style="margin: 7px 0 5px 0;padding:0" href="https://dataclass.org.ua" target="_blank"><img src="https://dataclass.org.ua/assets/template/images/dataclass_logo.png"></a><a href="./" style="font-weight:600; font-size:18px; padding:0">Вступ до R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Загальна інформація</a></li>
<li class="chapter" data-level="1" data-path="chapter1.html"><a href="chapter1.html"><i class="fa fa-check"></i><b>1</b> Вступ до курсу</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter1.html"><a href="chapter1.html#chapter11"><i class="fa fa-check"></i><b>1.1</b> Що таке R?</a></li>
<li class="chapter" data-level="1.2" data-path="chapter1.html"><a href="chapter1.html#chapter12"><i class="fa fa-check"></i><b>1.2</b> Історія створення R</a></li>
<li class="chapter" data-level="1.3" data-path="chapter1.html"><a href="chapter1.html#chapter13"><i class="fa fa-check"></i><b>1.3</b> Основи роботи з R</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="chapter1.html"><a href="chapter1.html#chapter131"><i class="fa fa-check"></i><b>1.3.1</b> R Project</a></li>
<li class="chapter" data-level="1.3.2" data-path="chapter1.html"><a href="chapter1.html#chapter132"><i class="fa fa-check"></i><b>1.3.2</b> Робота з R Studio</a></li>
<li class="chapter" data-level="1.3.3" data-path="chapter1.html"><a href="chapter1.html#chapter133"><i class="fa fa-check"></i><b>1.3.3</b> Робота з Jupyter Notebook</a></li>
<li class="chapter" data-level="1.3.4" data-path="chapter1.html"><a href="chapter1.html#chapter134"><i class="fa fa-check"></i><b>1.3.4</b> Огляд додаткових IDE та сервісів для роботи з R</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="chapter1.html"><a href="chapter1.html#chapter14"><i class="fa fa-check"></i><b>1.4</b> Основи роботи з пакетами в R</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="chapter1.html"><a href="chapter1.html#chapter141"><i class="fa fa-check"></i><b>1.4.1</b> Команди для роботи з пакетами</a></li>
<li class="chapter" data-level="1.4.2" data-path="chapter1.html"><a href="chapter1.html#chapter142"><i class="fa fa-check"></i><b>1.4.2</b> Робота з пакетами в RStudio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter2.html"><a href="chapter2.html"><i class="fa fa-check"></i><b>2</b> Базові конструкції мови R: типи та структури даних. Частина 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter2.html"><a href="chapter2.html#chapter21"><i class="fa fa-check"></i><b>2.1</b> Оголошення та ініціалізація змінних</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter2.html"><a href="chapter2.html#chapter211"><i class="fa fa-check"></i><b>2.1.1</b> Поняття змінних та оператор присвоєння</a></li>
<li class="chapter" data-level="2.1.2" data-path="chapter2.html"><a href="chapter2.html#chapter212"><i class="fa fa-check"></i><b>2.1.2</b> Правила іменування змінних</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter2.html"><a href="chapter2.html#chapter22"><i class="fa fa-check"></i><b>2.2</b> Базові типи даних</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chapter2.html"><a href="chapter2.html#chapter221"><i class="fa fa-check"></i><b>2.2.1</b> Типізація в R</a></li>
<li class="chapter" data-level="2.2.2" data-path="chapter2.html"><a href="chapter2.html#chapter222"><i class="fa fa-check"></i><b>2.2.2</b> Перевірка та привдення типів даних</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chapter2.html"><a href="chapter2.html#chapter23"><i class="fa fa-check"></i><b>2.3</b> Оператори</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="chapter2.html"><a href="chapter2.html#chapter231"><i class="fa fa-check"></i><b>2.3.1</b> Арифметичні оператори</a></li>
<li class="chapter" data-level="2.3.2" data-path="chapter2.html"><a href="chapter2.html#chapter232"><i class="fa fa-check"></i><b>2.3.2</b> Оператори відношення</a></li>
<li class="chapter" data-level="2.3.3" data-path="chapter2.html"><a href="chapter2.html#chapter233"><i class="fa fa-check"></i><b>2.3.3</b> Логічні оператори</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chapter2.html"><a href="chapter2.html#chapter24"><i class="fa fa-check"></i><b>2.4</b> Корисні математичні функції</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="chapter2.html"><a href="chapter2.html#chapter241"><i class="fa fa-check"></i><b>2.4.1</b> Заокруглення чисел (round, ceiling, floor, trunc, signif)</a></li>
<li class="chapter" data-level="2.4.2" data-path="chapter2.html"><a href="chapter2.html#chapter242"><i class="fa fa-check"></i><b>2.4.2</b> Послідовності чисел (seq, rep)</a></li>
<li class="chapter" data-level="2.4.3" data-path="chapter2.html"><a href="chapter2.html#chapter243"><i class="fa fa-check"></i><b>2.4.3</b> Генерація псевдовипадкових чисел</a></li>
<li class="chapter" data-level="2.4.4" data-path="chapter2.html"><a href="chapter2.html#chapter244"><i class="fa fa-check"></i><b>2.4.4</b> Інші математичні функції та константи R</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="chapter2.html"><a href="chapter2.html#chapter245"><i class="fa fa-check"></i><b>2.5</b> Введення-виведння даних</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter3.html"><a href="chapter3.html"><i class="fa fa-check"></i><b>3</b> Базові конструкції мови R: типи та структури даних. Частина 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter3.html"><a href="chapter3.html#chapter31"><i class="fa fa-check"></i><b>3.1</b> Набори даних</a></li>
<li class="chapter" data-level="3.2" data-path="chapter3.html"><a href="chapter3.html#chapter32"><i class="fa fa-check"></i><b>3.2</b> Вектори (vectors)</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="chapter3.html"><a href="chapter3.html#chapter321"><i class="fa fa-check"></i><b>3.2.1</b> Поняття та спосіб представлення</a></li>
<li class="chapter" data-level="3.2.2" data-path="chapter3.html"><a href="chapter3.html#chapter322"><i class="fa fa-check"></i><b>3.2.2</b> Оголошення векторів</a></li>
<li class="chapter" data-level="3.2.3" data-path="chapter3.html"><a href="chapter3.html#chapter323"><i class="fa fa-check"></i><b>3.2.3</b> Операції над векторами</a></li>
<li class="chapter" data-level="3.2.4" data-path="chapter3.html"><a href="chapter3.html#naming-vector-elements"><i class="fa fa-check"></i><b>3.2.4</b> Naming vector elements</a></li>
<li class="chapter" data-level="3.2.5" data-path="chapter3.html"><a href="chapter3.html#access-to-vector-elements"><i class="fa fa-check"></i><b>3.2.5</b> Access to vector elements</a></li>
<li class="chapter" data-level="3.2.6" data-path="chapter3.html"><a href="chapter3.html#useful-functions"><i class="fa fa-check"></i><b>3.2.6</b> Useful functions</a></li>
<li class="chapter" data-level="3.2.7" data-path="chapter3.html"><a href="chapter3.html#correction-of-data-na-nan-inf"><i class="fa fa-check"></i><b>3.2.7</b> Correction of data (NA, NaN, Inf)</a></li>
<li class="chapter" data-level="3.2.8" data-path="chapter3.html"><a href="chapter3.html#tasks"><i class="fa fa-check"></i><b>3.2.8</b> Tasks</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chapter3.html"><a href="chapter3.html#matrices"><i class="fa fa-check"></i><b>3.3</b> Matrices</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="chapter3.html"><a href="chapter3.html#creating-matrices"><i class="fa fa-check"></i><b>3.3.1</b> Creating matrices</a></li>
<li class="chapter" data-level="3.3.2" data-path="chapter3.html"><a href="chapter3.html#naming-matrices"><i class="fa fa-check"></i><b>3.3.2</b> Naming matrices</a></li>
<li class="chapter" data-level="3.3.3" data-path="chapter3.html"><a href="chapter3.html#access-to-matrix-elements"><i class="fa fa-check"></i><b>3.3.3</b> Access to matrix elements</a></li>
<li class="chapter" data-level="3.3.4" data-path="chapter3.html"><a href="chapter3.html#useful-functions-1"><i class="fa fa-check"></i><b>3.3.4</b> Useful functions</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chapter3.html"><a href="chapter3.html#factors"><i class="fa fa-check"></i><b>3.4</b> Factors</a></li>
<li class="chapter" data-level="3.5" data-path="chapter3.html"><a href="chapter3.html#dataframes"><i class="fa fa-check"></i><b>3.5</b> Dataframes</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="chapter3.html"><a href="chapter3.html#creating-data-frames"><i class="fa fa-check"></i><b>3.5.1</b> Creating Data Frames</a></li>
<li class="chapter" data-level="3.5.2" data-path="chapter3.html"><a href="chapter3.html#extending-data-frames"><i class="fa fa-check"></i><b>3.5.2</b> Extending data frames</a></li>
<li class="chapter" data-level="3.5.3" data-path="chapter3.html"><a href="chapter3.html#merge-df"><i class="fa fa-check"></i><b>3.5.3</b> Merge DF</a></li>
<li class="chapter" data-level="3.5.4" data-path="chapter3.html"><a href="chapter3.html#subsetting-data-frames"><i class="fa fa-check"></i><b>3.5.4</b> Subsetting Data Frames</a></li>
<li class="chapter" data-level="3.5.5" data-path="chapter3.html"><a href="chapter3.html#order-data.frame"><i class="fa fa-check"></i><b>3.5.5</b> Order data.frame</a></li>
<li class="chapter" data-level="3.5.6" data-path="chapter3.html"><a href="chapter3.html#manipulating-data.frames"><i class="fa fa-check"></i><b>3.5.6</b> Manipulating data.frames</a></li>
<li class="chapter" data-level="3.5.7" data-path="chapter3.html"><a href="chapter3.html#tasks-on-data.frames"><i class="fa fa-check"></i><b>3.5.7</b> Tasks on data.frames</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="chapter3.html"><a href="chapter3.html#lists"><i class="fa fa-check"></i><b>3.6</b> Lists</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="chapter3.html"><a href="chapter3.html#creating-a-list"><i class="fa fa-check"></i><b>3.6.1</b> Creating a List</a></li>
<li class="chapter" data-level="3.6.2" data-path="chapter3.html"><a href="chapter3.html#naming-list-elements"><i class="fa fa-check"></i><b>3.6.2</b> Naming List Elements</a></li>
<li class="chapter" data-level="3.6.3" data-path="chapter3.html"><a href="chapter3.html#accessing-list-elements"><i class="fa fa-check"></i><b>3.6.3</b> Accessing List Elements</a></li>
<li class="chapter" data-level="3.6.4" data-path="chapter3.html"><a href="chapter3.html#manipulating-list-elements"><i class="fa fa-check"></i><b>3.6.4</b> Manipulating List Elements</a></li>
<li class="chapter" data-level="3.6.5" data-path="chapter3.html"><a href="chapter3.html#tasks-1"><i class="fa fa-check"></i><b>3.6.5</b> TASKS</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="chapter3.html"><a href="chapter3.html#apply-functions-family"><i class="fa fa-check"></i><b>3.7</b> Apply functions family</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="chapter3.html"><a href="chapter3.html#the-apply-functions-family"><i class="fa fa-check"></i><b>3.7.1</b> The apply() functions family</a></li>
<li class="chapter" data-level="3.7.2" data-path="chapter3.html"><a href="chapter3.html#apply"><i class="fa fa-check"></i><b>3.7.2</b> apply()</a></li>
<li class="chapter" data-level="3.7.3" data-path="chapter3.html"><a href="chapter3.html#lapply"><i class="fa fa-check"></i><b>3.7.3</b> lapply()</a></li>
<li class="chapter" data-level="3.7.4" data-path="chapter3.html"><a href="chapter3.html#sapplay"><i class="fa fa-check"></i><b>3.7.4</b> sapplay()</a></li>
<li class="chapter" data-level="3.7.5" data-path="chapter3.html"><a href="chapter3.html#aggregate"><i class="fa fa-check"></i><b>3.7.5</b> aggregate()</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="chapter3.html"><a href="chapter3.html#references"><i class="fa fa-check"></i><b>3.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter4.html"><a href="chapter4.html"><i class="fa fa-check"></i><b>4</b> Збір та читання інформації з різноманітних джерел: файли, веб-сторінки, бази R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter4.html"><a href="chapter4.html#chapter41"><i class="fa fa-check"></i><b>4.1</b> Загальний опис структури даних</a></li>
<li class="chapter" data-level="4.2" data-path="chapter4.html"><a href="chapter4.html#chapter42"><i class="fa fa-check"></i><b>4.2</b> Опис набору даних <code>Telecom Users</code></a></li>
<li class="chapter" data-level="4.3" data-path="chapter3.html"><a href="chapter3.html#chapter321"><i class="fa fa-check"></i><b>4.3</b> Імпорт даних засобами RStudio</a></li>
<li class="chapter" data-level="4.4" data-path="chapter4.html"><a href="chapter4.html#chapter43"><i class="fa fa-check"></i><b>4.4</b> CSV-файли: читання, запис</a></li>
<li class="chapter" data-level="4.5" data-path="chapter4.html"><a href="chapter4.html#chapter44"><i class="fa fa-check"></i><b>4.5</b> Excel (xlsx): читання, запис</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="chapter4.html"><a href="chapter4.html#chapter441"><i class="fa fa-check"></i><b>4.5.1</b> Task 2.1</a></li>
<li class="chapter" data-level="4.5.2" data-path="chapter4.html"><a href="chapter4.html#chapter442"><i class="fa fa-check"></i><b>4.5.2</b> Solution for Task 2.1</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="chapter4.html"><a href="chapter4.html#chapter45"><i class="fa fa-check"></i><b>4.6</b> XML: читання, запис</a></li>
<li class="chapter" data-level="4.7" data-path="chapter4.html"><a href="chapter4.html#chapter46"><i class="fa fa-check"></i><b>4.7</b> JSON and API</a></li>
<li class="chapter" data-level="4.8" data-path="chapter4.html"><a href="chapter4.html#chapter46"><i class="fa fa-check"></i><b>4.8</b> Google Services</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="chapter4.html"><a href="chapter4.html#chapter461"><i class="fa fa-check"></i><b>4.8.1</b> Spreadsheets</a></li>
<li class="chapter" data-level="4.8.2" data-path="chapter4.html"><a href="chapter4.html#chapter462"><i class="fa fa-check"></i><b>4.8.2</b> Trends</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="chapter4.html"><a href="chapter4.html#chapter47"><i class="fa fa-check"></i><b>4.9</b> SQL (SQLite sample)</a></li>
<li class="chapter" data-level="4.10" data-path="chapter4.html"><a href="chapter4.html#web-pages-html"><i class="fa fa-check"></i><b>4.10</b> Web-pages (HTML)</a></li>
<li class="chapter" data-level="4.11" data-path="chapter4.html"><a href="chapter4.html#references-1"><i class="fa fa-check"></i><b>4.11</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter5.html"><a href="chapter5.html"><i class="fa fa-check"></i><b>5</b> Прийоми маніпулювання даними (з використанням можливостей бібліотеки dplyr)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter5.html"><a href="chapter5.html#whats-dplyr"><i class="fa fa-check"></i><b>5.1</b> What’s dplyr</a></li>
<li class="chapter" data-level="5.2" data-path="chapter5.html"><a href="chapter5.html#exploring-data-with-dplyr"><i class="fa fa-check"></i><b>5.2</b> Exploring data with dplyr</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="chapter5.html"><a href="chapter5.html#funtions-and-dataset-explore"><i class="fa fa-check"></i><b>5.2.1</b> Funtions and dataset explore</a></li>
<li class="chapter" data-level="5.2.2" data-path="chapter5.html"><a href="chapter5.html#filter-function"><i class="fa fa-check"></i><b>5.2.2</b> filter() function</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="chapter5.html"><a href="chapter5.html#pipe-operator"><i class="fa fa-check"></i><b>5.3</b> Pipe (%&gt;%) operator</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chapter5.html"><a href="chapter5.html#select-function"><i class="fa fa-check"></i><b>5.3.1</b> select() function</a></li>
<li class="chapter" data-level="5.3.2" data-path="chapter5.html"><a href="chapter5.html#subset-rows-using-their-positions-with-slice"><i class="fa fa-check"></i><b>5.3.2</b> Subset rows using their positions with slice()</a></li>
<li class="chapter" data-level="5.3.3" data-path="chapter5.html"><a href="chapter5.html#sorting-with-arrange"><i class="fa fa-check"></i><b>5.3.3</b> Sorting with arrange()</a></li>
<li class="chapter" data-level="5.3.4" data-path="chapter5.html"><a href="chapter5.html#create-new-variables-with-mutate"><i class="fa fa-check"></i><b>5.3.4</b> Create new variables with mutate()</a></li>
<li class="chapter" data-level="5.3.5" data-path="chapter5.html"><a href="chapter5.html#renaming-columns-with-rename"><i class="fa fa-check"></i><b>5.3.5</b> Renaming columns with rename()</a></li>
<li class="chapter" data-level="5.3.6" data-path="chapter5.html"><a href="chapter5.html#calculations-with-group_by-summarise"><i class="fa fa-check"></i><b>5.3.6</b> Calculations with group_by() + summarise()</a></li>
<li class="chapter" data-level="5.3.7" data-path="chapter5.html"><a href="chapter5.html#task-on-credits"><i class="fa fa-check"></i><b>5.3.7</b> Task on Credits</a></li>
<li class="chapter" data-level="5.3.8" data-path="chapter5.html"><a href="chapter5.html#binding-rows-and-columns"><i class="fa fa-check"></i><b>5.3.8</b> Binding rows and columns</a></li>
<li class="chapter" data-level="5.3.9" data-path="chapter5.html"><a href="chapter5.html#joining-data"><i class="fa fa-check"></i><b>5.3.9</b> Join()ing data</a></li>
<li class="chapter" data-level="5.3.10" data-path="chapter5.html"><a href="chapter5.html#data-cleaning-with-gather"><i class="fa fa-check"></i><b>5.3.10</b> Data cleaning with gather()</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chapter5.html"><a href="chapter5.html#refences"><i class="fa fa-check"></i><b>5.4</b> Refences</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter8.html"><a href="chapter8.html"><i class="fa fa-check"></i><b>6</b> Представлення результатів аналізу даних.</a></li>
<li class="chapter" data-level="7" data-path="chapter7.html"><a href="chapter7.html"><i class="fa fa-check"></i><b>7</b> Побудова та навчання математичних моделей, метрики оцінки їх якості.</a></li>
<li class="chapter" data-level="8" data-path="chapter6.html"><a href="chapter6.html"><i class="fa fa-check"></i><b>8</b> Приклади задач та їх розв’язки</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter6.html"><a href="chapter6.html#chapter61"><i class="fa fa-check"></i><b>8.1</b> Задачі</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="chapter6.html"><a href="chapter6.html#chapter611"><i class="fa fa-check"></i><b>8.1.1</b> Послідовності</a></li>
<li class="chapter" data-level="8.1.2" data-path="chapter6.html"><a href="chapter6.html#chapter612"><i class="fa fa-check"></i><b>8.1.2</b> Функції</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="chapter6.html"><a href="chapter6.html#chapter62"><i class="fa fa-check"></i><b>8.2</b> Рішення задач</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="chapter6.html"><a href="chapter6.html#chapter621"><i class="fa fa-check"></i><b>8.2.1</b> Послідовності та вектори</a></li>
<li class="chapter" data-level="8.2.2" data-path="chapter6.html"><a href="chapter6.html#chapter622"><i class="fa fa-check"></i><b>8.2.2</b> Функції</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="-e-.html"><a href="-e-.html"><i class="fa fa-check"></i>Джeрела</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Створено з bookdown</a></li>
<li><a href="https://dataclass.org.ua" target="blank">Сайт проекту DataCalss</a></li>  
<li><a href="https://github.com/kleban/r-intro-pub/issues" style="color:#e53b49" target="blank"><i class="fas fa-bug"></i> Знайшли помилку?</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Підготовка, обробка та ефективне використання даних для наукових досліджень</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter4" class="section level1" number="4">
<h1><span class="header-section-number">Розділ 4</span> Збір та читання інформації з різноманітних джерел: файли, веб-сторінки, бази R</h1>
<p>Автори: Савчук Сергій, Юрій Клебан</p>
<hr />
<div id="chapter41" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Загальний опис структури даних</h2>
<div class="alert alert-danger">
<p><i class="fa-2x fas fa-alert fa-battery-quarter"></i>
Матеріали розділу у процесі підготовки.</p>
</div>
<p>Усі дані, що використовуються для наукових досліджень можна розділити на 3 блоки:</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="" />
Структуровані</li>
<li><input type="checkbox" disabled="" checked="" />
Слабоструктуровані</li>
<li><input type="checkbox" disabled="" checked="" />
Неструктуровані</li>
</ul>
<p><strong>Структуровані дані</strong> зазвичай зрозумілі для користувача, сформовані відповідно до певних вимог та дозволяють швидко їх вивчити, без додаткових процедур підготовки.</p>
<p>Важливою для нас характеристикою <strong>структурованих даних</strong> є те, що вони досить просто піддаються машинній обробці, аналізу та візуалізації.</p>
<p><strong>Слабоструктуровані дані</strong> часто можуть бути сприйняті людиною, проте форма їх подачі не дозволяє швидко проаналізувати її машиною.</p>
<p>Найпростішим прикладом структурованих даних є табличні дані, наприклад, в Microsoft Excel, де кожен рядок - це одне спостереження, а кожен стовпець - це одна характеристика.</p>
<p>Слабоструктуровані дані можуть бути перетворені до структурованих за допомогою підготовлених спеціалістом з по роботі з дадними алгоритмом. Подібний етап зазвчай потребує детального аналізу полів, форми по дання, визначення шаблонів помилок у даних тощо.</p>
<p><strong>Неструктуровані дані</strong></p>
</div>
<div id="chapter42" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Опис набору даних <code>Telecom Users</code></h2>
<div class="alert alert-info">
<p>Опис інформації про набір даних взято з сервісу <a href="https://kaggle.com"><code>kaggle.com</code></a>.<br>
Оригінальний набір розміщений за адресою <a href="https://www.kaggle.com/radmirzosimov/telecom-users-dataset"><code>https://www.kaggle.com/radmirzosimov/telecom-users-dataset</code></a>.</p>
</div>
<p><strong>Призначення</strong>:</p>
<p>Описаний датасет призначений для практикування спеціалістами з машинного навчання розв’язування задач класифікації.</p>
<p><strong>Опис:</strong></p>
<p>Any business wants to maximize the number of customers. To achieve this goal, it is important not only to try to attract new ones, but also to retain existing ones. Retaining a client will cost the company less than attracting a new one. In addition, a new client may be weakly interested in business services and it will be difficult to work with him, while old clients already have the necessary data on interaction with the service.</p>
<p>Accordingly, predicting the churn, we can react in time and try to keep the client who wants to leave. Based on the data about the services that the client uses, we can make him a special offer, trying to change his decision to leave the operator. This will make the task of retention easier to implement than the task of attracting new users, about which we do not know anything yet.</p>
<p>You are provided with a dataset from a telecommunications company. The data contains information about almost six thousand users, their demographic characteristics, the services they use, the duration of using the operator’s services, the method of payment, and the amount of payment.</p>
<p>The task is to analyze the data and predict the churn of users (to identify people who will and will not renew their contract). The work should include the following mandatory items:</p>
<ol style="list-style-type: decimal">
<li>Description of the data (with the calculation of basic statistics);</li>
<li>Research of dependencies and formulation of hypotheses;</li>
<li>Building models for predicting the outflow (with justification for the choice of a particular model) 4. based on tested hypotheses and identified relationships;</li>
<li>Comparison of the quality of the obtained models.</li>
</ol>
<p><strong>Опис полів набору даних:</strong></p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="" />
<code>customerID</code> - customer id</li>
<li><input type="checkbox" disabled="" checked="" />
<code>gender</code> - client gender (male / female)</li>
<li><input type="checkbox" disabled="" checked="" />
<code>SeniorCitizen</code> - is the client retired (1, 0)</li>
<li><input type="checkbox" disabled="" checked="" />
<code>Partner</code> - is the client married (Yes, No)</li>
<li><input type="checkbox" disabled="" checked="" />
<code>tenure</code> - how many months a person has been a client of the company</li>
<li><input type="checkbox" disabled="" checked="" />
<code>PhoneService</code> - is the telephone service connected (Yes, No)</li>
<li><input type="checkbox" disabled="" checked="" />
<code>MultipleLines</code> - are multiple phone lines connected (Yes, No, No phone service)</li>
<li><input type="checkbox" disabled="" checked="" />
<code>InternetService</code> - client’s Internet service provider (DSL, Fiber optic, No)</li>
<li><input type="checkbox" disabled="" checked="" />
<code>OnlineSecurity</code> - is the online security service connected (Yes, No, No internet service)</li>
<li><input type="checkbox" disabled="" checked="" />
<code>OnlineBackup</code> - is the online backup service activated (Yes, No, No internet service)</li>
<li><input type="checkbox" disabled="" checked="" />
<code>DeviceProtection</code> - does the client have equipment insurance (Yes, No, No internet service)</li>
<li><input type="checkbox" disabled="" checked="" />
<code>TechSupport</code> - is the technical support service connected (Yes, No, No internet service)</li>
<li><input type="checkbox" disabled="" checked="" />
<code>StreamingTV</code> - is the streaming TV service connected (Yes, No, No internet service)</li>
<li><input type="checkbox" disabled="" checked="" />
<code>StreamingMovies</code> - is the streaming cinema service activated (Yes, No, No internet service)</li>
<li><input type="checkbox" disabled="" checked="" />
<code>Contract</code> - type of customer contract (Month-to-month, One year, Two year)</li>
<li><input type="checkbox" disabled="" checked="" />
<code>PaperlessBilling</code> - whether the client uses paperless billing (Yes, No)</li>
<li><input type="checkbox" disabled="" checked="" />
<code>PaymentMethod</code> - payment method (Electronic check, Mailed check, Bank transfer (automatic), Credit card (automatic))</li>
<li><input type="checkbox" disabled="" checked="" />
<code>MonthlyCharges</code> - current monthly payment</li>
<li><input type="checkbox" disabled="" checked="" />
<code>TotalCharges</code> - the total amount that the client paid for the services for the entire time</li>
<li><input type="checkbox" disabled="" checked="" />
<code>Churn - whether</code> there was a churn (Yes or No)</li>
</ul>
</div>
<div id="chapter321" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Імпорт даних засобами RStudio</h2>
<p><code>RStudio</code> має ряд засобів для</p>
</div>
<div id="chapter43" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> CSV-файли: читання, запис</h2>
<p><strong>CSV</strong> - це тип файлів, у якому інформація розділена комами (<code>Comma Separated Values</code>). CSV є досить зручним форматом даних для передачі між різними машинами, адже по суті є текстовим файлом і дозволяє легко його зчитати.</p>
<p><em>Примітка. Наспрвді кома не завжди є роздільником CSV-файлів. Це можуть бути і інші символи.</em></p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="chapter4.html#cb562-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lets check current working directory to write correct files path</span></span>
<span id="cb562-2"><a href="chapter4.html#cb562-2" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code></pre></div>
<pre><code>## [1] &quot;E:/Repos/YuRa/r-science-dev&quot;</code></pre>
<p>You can use / or \ for writing correct path in R. For example:</p>
<pre><code>path = &quot;d:/projects/file.csv&quot;
path = &quot;d:\\projects\\file.csv&quot;</code></pre>
<p>To combine path use paste() or paste0() functions</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="chapter4.html#cb565-1" aria-hidden="true" tabindex="-1"></a>work_dir <span class="ot">=</span> <span class="fu">getwd</span>()</span>
<span id="cb565-2"><a href="chapter4.html#cb565-2" aria-hidden="true" tabindex="-1"></a>work_dir </span></code></pre></div>
<pre><code>## [1] &quot;E:/Repos/YuRa/r-science-dev&quot;</code></pre>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="chapter4.html#cb567-1" aria-hidden="true" tabindex="-1"></a>file_name <span class="ot">=</span> <span class="st">&quot;temp_file.csv&quot;</span></span>
<span id="cb567-2"><a href="chapter4.html#cb567-2" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">=</span> <span class="fu">paste0</span>(work_dir, <span class="st">&quot;/&quot;</span>, file_name)</span>
<span id="cb567-3"><a href="chapter4.html#cb567-3" aria-hidden="true" tabindex="-1"></a>file_path</span></code></pre></div>
<pre><code>## [1] &quot;E:/Repos/YuRa/r-science-dev/temp_file.csv&quot;</code></pre>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="chapter4.html#cb569-1" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">=</span> <span class="fu">paste</span>(work_dir, file_name, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb569-2"><a href="chapter4.html#cb569-2" aria-hidden="true" tabindex="-1"></a>file_path</span></code></pre></div>
<pre><code>## [1] &quot;E:/Repos/YuRa/r-science-dev/temp_file.csv&quot;</code></pre>
<p>Thare are few methods for reading/writing csv in <code>base</code> package:</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="" />
<code>read.csv()</code>, <code>write.csv</code> - default data separator is <code>,</code>, decimal is separator <code>.</code>.</li>
<li><input type="checkbox" disabled="" checked="" />
<code>read.csv2()</code>, <code>write.csv2</code> - default data separator is <code>;</code>, decimal is separator <code>,</code>.</li>
</ul>
<p>Before using any new function check it usage information with <code>help(function_name)</code> or <code>?function_name</code>,<code>example:</code>?read.csv`.</p>
<p>You can read (current data set has NA values as example, there are no NA in original datase):</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="chapter4.html#cb571-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">&quot;data/telecom_users.csv&quot;</span>) <span class="co"># default reading</span></span></code></pre></div>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="chapter4.html#cb572-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">&quot;data/telecom_users.csv&quot;</span>,</span>
<span id="cb572-2"><a href="chapter4.html#cb572-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="co"># comma not only possibel separator</span></span>
<span id="cb572-3"><a href="chapter4.html#cb572-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dec =</span> <span class="st">&quot;.&quot;</span>, <span class="co"># decimal separator can be different</span></span>
<span id="cb572-4"><a href="chapter4.html#cb572-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;NA&quot;</span>, <span class="st">&quot;NULL&quot;</span>)) <span class="co"># you can define NA values</span></span></code></pre></div>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="chapter4.html#cb573-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data) <span class="co"># chack data structure / types/ values</span></span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    5986 obs. of  22 variables:
##  $ X               : int  1869 4528 6344 6739 432 2215 5260 6001 1480 5137 ...
##  $ customerID      : chr  &quot;7010-BRBUU&quot; &quot;9688-YGXVR&quot; &quot;9286-DOJGF&quot; &quot;6994-KERXL&quot; ...
##  $ gender          : chr  &quot;Male&quot; &quot;Female&quot; &quot;Female&quot; &quot;Male&quot; ...
##  $ SeniorCitizen   : int  0 0 1 0 0 0 0 0 0 1 ...
##  $ Partner         : chr  &quot;Yes&quot; &quot;No&quot; &quot;Yes&quot; &quot;No&quot; ...
##  $ Dependents      : chr  &quot;Yes&quot; &quot;No&quot; &quot;No&quot; &quot;No&quot; ...
##  $ tenure          : int  72 44 38 4 2 70 33 1 39 55 ...
##  $ PhoneService    : chr  &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; ...
##  $ MultipleLines   : chr  &quot;Yes&quot; &quot;No&quot; &quot;Yes&quot; &quot;No&quot; ...
##  $ InternetService : chr  &quot;No&quot; &quot;Fiber optic&quot; &quot;Fiber optic&quot; &quot;DSL&quot; ...
##  $ OnlineSecurity  : chr  &quot;No internet service&quot; &quot;No&quot; &quot;No&quot; &quot;No&quot; ...
##  $ OnlineBackup    : chr  &quot;No internet service&quot; &quot;Yes&quot; &quot;No&quot; &quot;No&quot; ...
##  $ DeviceProtection: chr  &quot;No internet service&quot; &quot;Yes&quot; &quot;No&quot; &quot;No&quot; ...
##  $ TechSupport     : chr  &quot;No internet service&quot; &quot;No&quot; &quot;No&quot; &quot;No&quot; ...
##  $ StreamingTV     : chr  &quot;No internet service&quot; &quot;Yes&quot; &quot;No&quot; &quot;No&quot; ...
##  $ StreamingMovies : chr  &quot;No internet service&quot; &quot;No&quot; &quot;No&quot; &quot;Yes&quot; ...
##  $ Contract        : chr  &quot;Two year&quot; &quot;Month-to-month&quot; &quot;Month-to-month&quot; &quot;Month-to-month&quot; ...
##  $ PaperlessBilling: chr  &quot;No&quot; &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; ...
##  $ PaymentMethod   : chr  &quot;Credit card (automatic)&quot; &quot;Credit card (automatic)&quot; &quot;Bank transfer (automatic)&quot; &quot;Electronic check&quot; ...
##  $ MonthlyCharges  : num  24.1 88.2 75 55.9 53.5 ...
##  $ TotalCharges    : num  1735 3973 2870 238 120 ...
##  $ Churn           : chr  &quot;No&quot; &quot;No&quot; &quot;Yes&quot; &quot;No&quot; ...</code></pre>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="chapter4.html#cb575-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data) <span class="co"># top 6 rows, use n = X, for viewing top X lines</span></span></code></pre></div>
<pre><code>##      X customerID gender SeniorCitizen Partner Dependents tenure PhoneService
## 1 1869 7010-BRBUU   Male             0     Yes        Yes     72          Yes
## 2 4528 9688-YGXVR Female             0      No         No     44          Yes
## 3 6344 9286-DOJGF Female             1     Yes         No     38          Yes
## 4 6739 6994-KERXL   Male             0      No         No      4          Yes
## 5  432 2181-UAESM   Male             0      No         No      2          Yes
## 6 2215 4312-GVYNH Female             0     Yes         No     70           No
##      MultipleLines InternetService      OnlineSecurity        OnlineBackup
## 1              Yes              No No internet service No internet service
## 2               No     Fiber optic                  No                 Yes
## 3              Yes     Fiber optic                  No                  No
## 4               No             DSL                  No                  No
## 5               No             DSL                 Yes                  No
## 6 No phone service             DSL                 Yes                  No
##      DeviceProtection         TechSupport         StreamingTV
## 1 No internet service No internet service No internet service
## 2                 Yes                  No                 Yes
## 3                  No                  No                  No
## 4                  No                  No                  No
## 5                 Yes                  No                  No
## 6                 Yes                 Yes                  No
##       StreamingMovies       Contract PaperlessBilling             PaymentMethod
## 1 No internet service       Two year               No   Credit card (automatic)
## 2                  No Month-to-month              Yes   Credit card (automatic)
## 3                  No Month-to-month              Yes Bank transfer (automatic)
## 4                 Yes Month-to-month              Yes          Electronic check
## 5                  No Month-to-month               No          Electronic check
## 6                 Yes       Two year              Yes Bank transfer (automatic)
##   MonthlyCharges TotalCharges Churn
## 1          24.10      1734.65    No
## 2          88.15      3973.20    No
## 3          74.95      2869.85   Yes
## 4          55.90       238.50    No
## 5          53.45       119.50    No
## 6          49.85      3370.20    No</code></pre>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="chapter4.html#cb577-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.data.frame</span>(data) <span class="co"># if data is data.frame</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="chapter4.html#cb579-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(data)) <span class="co"># if dataframe contains any NA values</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="chapter4.html#cb581-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(<span class="fu">is.na</span>(data), <span class="dv">2</span>, any) <span class="co">#check NA by 2nd dimension - columns</span></span></code></pre></div>
<pre><code>##                X       customerID           gender    SeniorCitizen 
##            FALSE            FALSE            FALSE            FALSE 
##          Partner       Dependents           tenure     PhoneService 
##            FALSE            FALSE            FALSE            FALSE 
##    MultipleLines  InternetService   OnlineSecurity     OnlineBackup 
##            FALSE            FALSE            FALSE            FALSE 
## DeviceProtection      TechSupport      StreamingTV  StreamingMovies 
##            FALSE            FALSE            FALSE            FALSE 
##         Contract PaperlessBilling    PaymentMethod   MonthlyCharges 
##            FALSE            FALSE            FALSE             TRUE 
##     TotalCharges            Churn 
##             TRUE            FALSE</code></pre>
<p>Check <code>MonthlyCharges: TRUE</code> and <code>TotalCharges: TRUE</code>. These columns has NA-values.</p>
<p>Let’s replace them with <code>mean</code>:</p>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="chapter4.html#cb583-1" aria-hidden="true" tabindex="-1"></a>data[<span class="fu">is.na</span>(data<span class="sc">$</span>TotalCharges), <span class="st">&quot;TotalCharges&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>TotalCharges, <span class="at">na.rm =</span> T)</span>
<span id="cb583-2"><a href="chapter4.html#cb583-2" aria-hidden="true" tabindex="-1"></a>data[<span class="fu">is.na</span>(data<span class="sc">$</span>MonthlyCharges), <span class="st">&quot;MonthlyCharges&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>MonthlyCharges, <span class="at">na.rm =</span> T)</span>
<span id="cb583-3"><a href="chapter4.html#cb583-3" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(data)) <span class="co"># check for NA</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>You can write data with <code>write.csv()</code>, <code>write.csv2()</code> from <code>base</code> package.</p>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="chapter4.html#cb585-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(data, <span class="at">file =</span> <span class="st">&quot;data/cleaned_data.csv&quot;</span>, <span class="at">row.names =</span> F)</span>
<span id="cb585-2"><a href="chapter4.html#cb585-2" aria-hidden="true" tabindex="-1"></a><span class="co"># by default row.names = TRUE and file will contains first columns with row numbers 1,2, ..., N</span></span></code></pre></div>
<p>One more useful package is <code>readr</code>. Examples of using:</p>
<pre><code>#install.packages(“readr”)
library(readr)
data &lt;- read_csv(file = &quot;data/telecom_users.csv&quot;, … )
data &lt;- read_csv2(file = &quot;data/telecom_users.csv&quot;, … )</code></pre>
<hr />
</div>
<div id="chapter44" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Excel (xlsx): читання, запис</h2>
<p>There are many packages to read/write MS Excel files. <code>xlsx</code> one of the most useful.</p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="chapter4.html#cb587-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;xlsx&quot;) install before use it</span></span>
<span id="cb587-2"><a href="chapter4.html#cb587-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xlsx)</span></code></pre></div>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="chapter4.html#cb588-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;xlsx&quot;</span>, <span class="fu">installed.packages</span>())) <span class="co"># check if package installed</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p><strong><code>?read.xlsx</code></strong> - review package functions and params</p>
<p>Let’s read the data <code>telecom_users.xlsx</code>:</p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="chapter4.html#cb590-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">&quot;data/telecom_users.xlsx&quot;</span>, <span class="at">sheetIndex =</span> <span class="dv">1</span>)</span>
<span id="cb590-2"><a href="chapter4.html#cb590-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sheetIndex = 1 - select sheet to read, or use sheetName = &quot;sheet1&quot; to read by Name</span></span></code></pre></div>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="chapter4.html#cb591-1" aria-hidden="true" tabindex="-1"></a><span class="co"># You can also use startRow, endRow and other params to define how mutch data read</span></span>
<span id="cb591-2"><a href="chapter4.html#cb591-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">&quot;data/telecom_users.xlsx&quot;</span>, <span class="at">sheetIndex =</span> <span class="dv">1</span>, <span class="at">endRow =</span> <span class="dv">100</span>)</span></code></pre></div>
<p>Let’s replace <code>Churn</code> values <code>Yes</code>/<code>No</code> by <code>1</code>/<code>0</code>:</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="chapter4.html#cb592-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data<span class="sc">$</span>Churn)</span></code></pre></div>
<pre><code>## [1] &quot;No&quot;  &quot;No&quot;  &quot;Yes&quot; &quot;No&quot;  &quot;No&quot;  &quot;No&quot;</code></pre>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="chapter4.html#cb594-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Churn <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>Churn <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="chapter4.html#cb595-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data<span class="sc">$</span>Churn)</span></code></pre></div>
<pre><code>## [1] 0 0 1 0 0 0</code></pre>
<p>Write final data to csv:</p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="chapter4.html#cb597-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.xlsx</span>(data, <span class="at">file =</span> <span class="st">&quot;data/final_telecom_data.xlsx&quot;</span>)</span></code></pre></div>
<div id="chapter441" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Task 2.1</h3>
<p>Download from kaggle.com and read dataset <code>Default_Fin.csv</code>:
<a href="https://www.kaggle.com/kmldas/loan-default-prediction" class="uri">https://www.kaggle.com/kmldas/loan-default-prediction</a></p>
<p><em>Description:</em></p>
<p>This is a synthetic dataset created using actual data from a financial institution. The data has been modified to remove identifiable features and the numbers transformed to ensure they do not link to original source (financial institution).</p>
<p>This is intended to be used for academic purposes for beginners who want to practice financial analytics from a simple financial dataset.</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="" />
<code>Index</code> - This is the serial number or unique identifier of the loan taker</li>
<li><input type="checkbox" disabled="" checked="" />
<code>Employed</code> - This is a Boolean 1= employed 0= unemployed</li>
<li><input type="checkbox" disabled="" checked="" />
<code>Bank.Balance</code> - Bank Balance of the loan taker</li>
<li><input type="checkbox" disabled="" checked="" />
<code>Annual.Salary</code> - Annual salary of the loan taker<br />
</li>
<li><input type="checkbox" disabled="" checked="" />
<code>Defaulted</code> - This is a Boolean 1= defaulted 0= not defaulted</li>
</ul>
<ol style="list-style-type: decimal">
<li>Check what columns has missing values</li>
<li>Count default and non-default clients / and parts of total clients in %</li>
<li>Count Employed clients</li>
<li>Count Employed Default clients</li>
<li>Average salary by Employed clients</li>
<li>Rename columns to “id,” “empl,” “balance,” “salary,” “default”</li>
</ol>
<hr />
</div>
<div id="chapter442" class="section level3" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Solution for Task 2.1</h3>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="chapter4.html#cb598-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/Default_Fin.csv&quot;</span>)</span>
<span id="cb598-2"><a href="chapter4.html#cb598-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<pre><code>##   Index Employed Bank.Balance Annual.Salary Defaulted.
## 1     1        1      8754.36     532339.56          0
## 2     2        0      9806.16     145273.56          0
## 3     3        1     12882.60     381205.68          0
## 4     4        1      6351.00     428453.88          0
## 5     5        1      9427.92     461562.00          0
## 6     6        0     11035.08      89898.72          0</code></pre>
<blockquote>
<ol style="list-style-type: decimal">
<li>Check what columns has missing values</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="chapter4.html#cb600-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(data))</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<blockquote>
<ol start="2" style="list-style-type: decimal">
<li>Count default and non-default clients / and parts of total clients in %</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="chapter4.html#cb602-1" aria-hidden="true" tabindex="-1"></a>def_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data[data<span class="sc">$</span>Defaulted. <span class="sc">==</span> <span class="dv">1</span>, ])</span>
<span id="cb602-2"><a href="chapter4.html#cb602-2" aria-hidden="true" tabindex="-1"></a>no_def_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data[data<span class="sc">$</span>Defaulted. <span class="sc">==</span> <span class="dv">0</span>, ])</span>
<span id="cb602-3"><a href="chapter4.html#cb602-3" aria-hidden="true" tabindex="-1"></a>def_count</span></code></pre></div>
<pre><code>## [1] 333</code></pre>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="chapter4.html#cb604-1" aria-hidden="true" tabindex="-1"></a>no_def_count </span></code></pre></div>
<pre><code>## [1] 9667</code></pre>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="chapter4.html#cb606-1" aria-hidden="true" tabindex="-1"></a>def_count <span class="sc">/</span> <span class="fu">nrow</span>(data) <span class="sc">*</span> <span class="dv">100</span> <span class="co"># part defaults</span></span></code></pre></div>
<pre><code>## [1] 3.33</code></pre>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="chapter4.html#cb608-1" aria-hidden="true" tabindex="-1"></a>no_def_count <span class="sc">/</span> <span class="fu">nrow</span>(data) <span class="sc">*</span> <span class="dv">100</span> <span class="co"># part non-defaults</span></span></code></pre></div>
<pre><code>## [1] 96.67</code></pre>
<blockquote>
<ol start="3" style="list-style-type: decimal">
<li>Count Employed clients</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="chapter4.html#cb610-1" aria-hidden="true" tabindex="-1"></a>empl <span class="ot">&lt;-</span> data[data<span class="sc">$</span>Employed <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb610-2"><a href="chapter4.html#cb610-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(empl)</span></code></pre></div>
<pre><code>## [1] 7056</code></pre>
<blockquote>
<ol start="4" style="list-style-type: decimal">
<li>Count Employed Default clients</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="chapter4.html#cb612-1" aria-hidden="true" tabindex="-1"></a>empl <span class="ot">&lt;-</span> data[data<span class="sc">$</span>Employed <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> data<span class="sc">$</span>Defaulted. <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb612-2"><a href="chapter4.html#cb612-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(empl)</span></code></pre></div>
<pre><code>## [1] 206</code></pre>
<blockquote>
<ol start="5" style="list-style-type: decimal">
<li>Average salary by Employed clients</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="chapter4.html#cb614-1" aria-hidden="true" tabindex="-1"></a>empl <span class="ot">&lt;-</span> data[data<span class="sc">$</span>Employed <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb614-2"><a href="chapter4.html#cb614-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(empl<span class="sc">$</span>Annual.Salary)</span></code></pre></div>
<pre><code>## [1] 480143.4</code></pre>
<blockquote>
<ol start="6" style="list-style-type: decimal">
<li>Rename columns to “id,” “empl,” “balance,” “salary,” “default”:</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="chapter4.html#cb616-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;empl&quot;</span>, <span class="st">&quot;balance&quot;</span>, <span class="st">&quot;salary&quot;</span>, <span class="st">&quot;default&quot;</span>)</span>
<span id="cb616-2"><a href="chapter4.html#cb616-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<pre><code>##   id empl  balance    salary default
## 1  1    1  8754.36 532339.56       0
## 2  2    0  9806.16 145273.56       0
## 3  3    1 12882.60 381205.68       0
## 4  4    1  6351.00 428453.88       0
## 5  5    1  9427.92 461562.00       0
## 6  6    0 11035.08  89898.72       0</code></pre>
<hr />
</div>
</div>
<div id="chapter45" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> XML: читання, запис</h2>
<p><code>XML</code> - eXtensible Markup Language.</p>
<p>For our example we will use data from <code>data/employes.xml</code>. File contains records with info:</p>
<pre><code>&lt;RECORDS&gt;
   &lt;EMPLOYEE&gt;
      &lt;ID&gt;1&lt;/ID&gt;
      &lt;NAME&gt;Rick&lt;/NAME&gt;
      &lt;SALARY&gt;623.3&lt;/SALARY&gt;
      &lt;STARTDATE&gt;1/1/2012&lt;/STARTDATE&gt;
      &lt;DEPT&gt;IT&lt;/DEPT&gt;
   &lt;/EMPLOYEE&gt;
   ...
&lt;/RECORDS&gt;</code></pre>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="chapter4.html#cb619-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;XML&quot;)</span></span>
<span id="cb619-2"><a href="chapter4.html#cb619-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;XML&quot;</span>)</span>
<span id="cb619-3"><a href="chapter4.html#cb619-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;methods&quot;)</span></span>
<span id="cb619-4"><a href="chapter4.html#cb619-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;methods&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="chapter4.html#cb620-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">xmlParse</span>(<span class="at">file =</span> <span class="st">&quot;data/employes.xml&quot;</span>)</span>
<span id="cb620-2"><a href="chapter4.html#cb620-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## &lt;?xml version=&quot;1.0&quot;?&gt;
## &lt;RECORDS&gt;
##   &lt;EMPLOYEE&gt;
##     &lt;ID&gt;1&lt;/ID&gt;
##     &lt;NAME&gt;Rick&lt;/NAME&gt;
##     &lt;SALARY&gt;623.3&lt;/SALARY&gt;
##     &lt;STARTDATE&gt;1/1/2012&lt;/STARTDATE&gt;
##     &lt;DEPT&gt;IT&lt;/DEPT&gt;
##   &lt;/EMPLOYEE&gt;
##   &lt;EMPLOYEE&gt;
##     &lt;ID&gt;2&lt;/ID&gt;
##     &lt;NAME&gt;Dan&lt;/NAME&gt;
##     &lt;SALARY&gt;515.2&lt;/SALARY&gt;
##     &lt;STARTDATE&gt;9/23/2013&lt;/STARTDATE&gt;
##     &lt;DEPT&gt;Operations&lt;/DEPT&gt;
##   &lt;/EMPLOYEE&gt;
##   &lt;EMPLOYEE&gt;
##     &lt;ID&gt;3&lt;/ID&gt;
##     &lt;NAME&gt;Michelle&lt;/NAME&gt;
##     &lt;SALARY&gt;611&lt;/SALARY&gt;
##     &lt;STARTDATE&gt;11/15/2014&lt;/STARTDATE&gt;
##     &lt;DEPT&gt;IT&lt;/DEPT&gt;
##   &lt;/EMPLOYEE&gt;
##   &lt;EMPLOYEE&gt;
##     &lt;ID&gt;4&lt;/ID&gt;
##     &lt;NAME&gt;Ryan&lt;/NAME&gt;
##     &lt;SALARY&gt;729&lt;/SALARY&gt;
##     &lt;STARTDATE&gt;5/11/2014&lt;/STARTDATE&gt;
##     &lt;DEPT&gt;HR&lt;/DEPT&gt;
##   &lt;/EMPLOYEE&gt;
##   &lt;EMPLOYEE&gt;
##     &lt;ID&gt;5&lt;/ID&gt;
##     &lt;NAME&gt;Gary&lt;/NAME&gt;
##     &lt;SALARY&gt;843.25&lt;/SALARY&gt;
##     &lt;STARTDATE&gt;3/27/2015&lt;/STARTDATE&gt;
##     &lt;DEPT&gt;Finance&lt;/DEPT&gt;
##   &lt;/EMPLOYEE&gt;
##   &lt;EMPLOYEE&gt;
##     &lt;ID&gt;6&lt;/ID&gt;
##     &lt;NAME&gt;Nina&lt;/NAME&gt;
##     &lt;SALARY&gt;578&lt;/SALARY&gt;
##     &lt;STARTDATE&gt;5/21/2013&lt;/STARTDATE&gt;
##     &lt;DEPT&gt;IT&lt;/DEPT&gt;
##   &lt;/EMPLOYEE&gt;
##   &lt;EMPLOYEE&gt;
##     &lt;ID&gt;7&lt;/ID&gt;
##     &lt;NAME&gt;Simon&lt;/NAME&gt;
##     &lt;SALARY&gt;632.8&lt;/SALARY&gt;
##     &lt;STARTDATE&gt;7/30/2013&lt;/STARTDATE&gt;
##     &lt;DEPT&gt;Operations&lt;/DEPT&gt;
##   &lt;/EMPLOYEE&gt;
##   &lt;EMPLOYEE&gt;
##     &lt;ID&gt;8&lt;/ID&gt;
##     &lt;NAME&gt;Guru&lt;/NAME&gt;
##     &lt;SALARY&gt;722.5&lt;/SALARY&gt;
##     &lt;STARTDATE&gt;6/17/2014&lt;/STARTDATE&gt;
##     &lt;DEPT&gt;Finance&lt;/DEPT&gt;
##   &lt;/EMPLOYEE&gt;
## &lt;/RECORDS&gt;
## </code></pre>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="chapter4.html#cb622-1" aria-hidden="true" tabindex="-1"></a>rootnode <span class="ot">&lt;-</span> <span class="fu">xmlRoot</span>(result) <span class="co"># reading rootnode of xml document</span></span>
<span id="cb622-2"><a href="chapter4.html#cb622-2" aria-hidden="true" tabindex="-1"></a>rootnode[[<span class="dv">1</span>]] <span class="co"># reading first record</span></span></code></pre></div>
<pre><code>## &lt;EMPLOYEE&gt;
##   &lt;ID&gt;1&lt;/ID&gt;
##   &lt;NAME&gt;Rick&lt;/NAME&gt;
##   &lt;SALARY&gt;623.3&lt;/SALARY&gt;
##   &lt;STARTDATE&gt;1/1/2012&lt;/STARTDATE&gt;
##   &lt;DEPT&gt;IT&lt;/DEPT&gt;
## &lt;/EMPLOYEE&gt;</code></pre>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="chapter4.html#cb624-1" aria-hidden="true" tabindex="-1"></a>rootnode[[<span class="dv">1</span>]][[<span class="dv">2</span>]] <span class="co"># reading first record in root node and second tag, its &lt;NAME&gt;</span></span></code></pre></div>
<pre><code>## &lt;NAME&gt;Rick&lt;/NAME&gt;</code></pre>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="chapter4.html#cb626-1" aria-hidden="true" tabindex="-1"></a>xmldataframe <span class="ot">&lt;-</span> <span class="fu">xmlToDataFrame</span>(<span class="st">&quot;data/employes.xml&quot;</span>)</span>
<span id="cb626-2"><a href="chapter4.html#cb626-2" aria-hidden="true" tabindex="-1"></a>xmldataframe</span></code></pre></div>
<pre><code>##   ID     NAME SALARY  STARTDATE       DEPT
## 1  1     Rick  623.3   1/1/2012         IT
## 2  2      Dan  515.2  9/23/2013 Operations
## 3  3 Michelle    611 11/15/2014         IT
## 4  4     Ryan    729  5/11/2014         HR
## 5  5     Gary 843.25  3/27/2015    Finance
## 6  6     Nina    578  5/21/2013         IT
## 7  7    Simon  632.8  7/30/2013 Operations
## 8  8     Guru  722.5  6/17/2014    Finance</code></pre>
</div>
<div id="chapter46" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> JSON and API</h2>
<p><code>JSON</code> (<code>JavaScript Object Notation</code>) is a lightweight data-interchange format. It is easy for humans to read and write. It is easy for machines to parse and generate. It is based on a subset of the JavaScript Programming Language Standard.</p>
<p><code>API</code> is the acronym for <code>Application Programming Interface</code>, which is a software intermediary that allows two applications to talk to each other.</p>
<p>One of the most popular packages for <code>json</code> is <code>jsonlite</code>.</p>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="chapter4.html#cb628-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;jsonlite&quot;)</span></span>
<span id="cb628-2"><a href="chapter4.html#cb628-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span></code></pre></div>
<p>Let’s use readinginformation about BTC and USDT crypro currencies from Binance</p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="chapter4.html#cb629-1" aria-hidden="true" tabindex="-1"></a>market <span class="ot">=</span> <span class="st">&#39;BTCUSDT&#39;</span></span>
<span id="cb629-2"><a href="chapter4.html#cb629-2" aria-hidden="true" tabindex="-1"></a>interval <span class="ot">=</span> <span class="st">&#39;1h&#39;</span></span>
<span id="cb629-3"><a href="chapter4.html#cb629-3" aria-hidden="true" tabindex="-1"></a>limit <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb629-4"><a href="chapter4.html#cb629-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb629-5"><a href="chapter4.html#cb629-5" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="at">url =</span> <span class="st">&quot;https://api.binance.com/api/v3/klines?symbol=&quot;</span>, market ,<span class="st">&quot;&amp;interval=&quot;</span>, interval,<span class="st">&quot;&amp;limit=&quot;</span>, limit)</span>
<span id="cb629-6"><a href="chapter4.html#cb629-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(url) <span class="co"># complete request URL</span></span></code></pre></div>
<pre><code>## [1] &quot;https://api.binance.com/api/v3/klines?symbol=BTCUSDT&amp;interval=1h&amp;limit=100&quot;</code></pre>
<p>On the nex stage you need use <code>fromJSON()</code> function to get data.</p>
<p>More details about requests to Binanace at <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#klinecandlestick-data" class="uri">https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#klinecandlestick-data</a></p>
<p>If you enter <code>url</code> value at browser response is going to be like this:</p>
<div class="sourceCode" id="cb631"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb631-1"><a href="chapter4.html#cb631-1" aria-hidden="true" tabindex="-1"></a><span class="ot">[</span></span>
<span id="cb631-2"><a href="chapter4.html#cb631-2" aria-hidden="true" tabindex="-1"></a>  <span class="ot">[</span></span>
<span id="cb631-3"><a href="chapter4.html#cb631-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1499040000000</span><span class="ot">,</span>      <span class="er">//</span> <span class="er">Open</span> <span class="er">time</span></span>
<span id="cb631-4"><a href="chapter4.html#cb631-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;0.01634790&quot;</span><span class="ot">,</span>       <span class="er">//</span> <span class="er">Open</span></span>
<span id="cb631-5"><a href="chapter4.html#cb631-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;0.80000000&quot;</span><span class="ot">,</span>       <span class="er">//</span> <span class="er">High</span></span>
<span id="cb631-6"><a href="chapter4.html#cb631-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;0.01575800&quot;</span><span class="ot">,</span>       <span class="er">//</span> <span class="er">Low</span></span>
<span id="cb631-7"><a href="chapter4.html#cb631-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;0.01577100&quot;</span><span class="ot">,</span>       <span class="er">//</span> <span class="er">Close</span></span>
<span id="cb631-8"><a href="chapter4.html#cb631-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;148976.11427815&quot;</span><span class="ot">,</span>  <span class="er">//</span> <span class="er">Volume</span></span>
<span id="cb631-9"><a href="chapter4.html#cb631-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1499644799999</span><span class="ot">,</span>      <span class="er">//</span> <span class="er">Close</span> <span class="er">time</span></span>
<span id="cb631-10"><a href="chapter4.html#cb631-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;2434.19055334&quot;</span><span class="ot">,</span>    <span class="er">//</span> <span class="er">Quote</span> <span class="er">asset</span> <span class="er">volume</span></span>
<span id="cb631-11"><a href="chapter4.html#cb631-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">308</span><span class="ot">,</span>                <span class="er">//</span> <span class="er">Number</span> <span class="er">of</span> <span class="er">trades</span></span>
<span id="cb631-12"><a href="chapter4.html#cb631-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;1756.87402397&quot;</span><span class="ot">,</span>    <span class="er">//</span> <span class="er">Taker</span> <span class="er">buy</span> <span class="er">base</span> <span class="er">asset</span> <span class="er">volume</span></span>
<span id="cb631-13"><a href="chapter4.html#cb631-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;28.46694368&quot;</span><span class="ot">,</span>      <span class="er">//</span> <span class="er">Taker</span> <span class="er">buy</span> <span class="er">quote</span> <span class="er">asset</span> <span class="er">volume</span></span>
<span id="cb631-14"><a href="chapter4.html#cb631-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;17928899.62484339&quot;</span> <span class="er">//</span> <span class="er">Ignore.</span></span>
<span id="cb631-15"><a href="chapter4.html#cb631-15" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span></span>
<span id="cb631-16"><a href="chapter4.html#cb631-16" aria-hidden="true" tabindex="-1"></a><span class="ot">]</span></span></code></pre></div>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="chapter4.html#cb632-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(url) <span class="co"># get json and transform it to list()</span></span>
<span id="cb632-2"><a href="chapter4.html#cb632-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>] <span class="co"># let&#39;s left only 1:7 columns (from Open time to Close time)</span></span>
<span id="cb632-3"><a href="chapter4.html#cb632-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<pre><code>##      [,1]            [,2]             [,3]             [,4]            
## [1,] &quot;1.625904e+12&quot;  &quot;33766.01000000&quot; &quot;33950.00000000&quot; &quot;33686.00000000&quot;
## [2,] &quot;1625907600000&quot; &quot;33761.72000000&quot; &quot;33900.00000000&quot; &quot;33711.95000000&quot;
## [3,] &quot;1625911200000&quot; &quot;33735.98000000&quot; &quot;33800.00000000&quot; &quot;33599.98000000&quot;
## [4,] &quot;1625914800000&quot; &quot;33624.09000000&quot; &quot;33911.82000000&quot; &quot;33565.00000000&quot;
## [5,] &quot;1625918400000&quot; &quot;33793.95000000&quot; &quot;33943.40000000&quot; &quot;33744.40000000&quot;
## [6,] &quot;1.625922e+12&quot;  &quot;33858.28000000&quot; &quot;33898.17000000&quot; &quot;33634.16000000&quot;
##      [,5]             [,6]            [,7]           
## [1,] &quot;33762.79000000&quot; &quot;1586.69013400&quot; &quot;1625907599999&quot;
## [2,] &quot;33732.57000000&quot; &quot;988.18051900&quot;  &quot;1625911199999&quot;
## [3,] &quot;33624.08000000&quot; &quot;1314.38690600&quot; &quot;1625914799999&quot;
## [4,] &quot;33793.94000000&quot; &quot;1674.95679800&quot; &quot;1625918399999&quot;
## [5,] &quot;33861.02000000&quot; &quot;1213.69747000&quot; &quot;1625921999999&quot;
## [6,] &quot;33700.31000000&quot; &quot;1331.15612700&quot; &quot;1625925599999&quot;</code></pre>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="chapter4.html#cb634-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(data) <span class="co"># check data type</span></span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="chapter4.html#cb636-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data) <span class="co"># convert to dataframe</span></span>
<span id="cb636-2"><a href="chapter4.html#cb636-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<pre><code>##              V1             V2             V3             V4             V5
## 1  1.625904e+12 33766.01000000 33950.00000000 33686.00000000 33762.79000000
## 2 1625907600000 33761.72000000 33900.00000000 33711.95000000 33732.57000000
## 3 1625911200000 33735.98000000 33800.00000000 33599.98000000 33624.08000000
## 4 1625914800000 33624.09000000 33911.82000000 33565.00000000 33793.94000000
## 5 1625918400000 33793.95000000 33943.40000000 33744.40000000 33861.02000000
## 6  1.625922e+12 33858.28000000 33898.17000000 33634.16000000 33700.31000000
##              V6            V7
## 1 1586.69013400 1625907599999
## 2  988.18051900 1625911199999
## 3 1314.38690600 1625914799999
## 4 1674.95679800 1625918399999
## 5 1213.69747000 1625921999999
## 6 1331.15612700 1625925599999</code></pre>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="chapter4.html#cb638-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fix columns names</span></span>
<span id="cb638-2"><a href="chapter4.html#cb638-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Open_time&quot;</span>, <span class="st">&quot;Open&quot;</span>, <span class="st">&quot;High&quot;</span>, <span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Close&quot;</span>, <span class="st">&quot;Volume&quot;</span>, <span class="st">&quot;Close_time&quot;</span>)</span>
<span id="cb638-3"><a href="chapter4.html#cb638-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data) <span class="co"># looks better, but columns are characters still</span></span></code></pre></div>
<pre><code>##       Open_time           Open           High            Low          Close
## 1  1.625904e+12 33766.01000000 33950.00000000 33686.00000000 33762.79000000
## 2 1625907600000 33761.72000000 33900.00000000 33711.95000000 33732.57000000
## 3 1625911200000 33735.98000000 33800.00000000 33599.98000000 33624.08000000
## 4 1625914800000 33624.09000000 33911.82000000 33565.00000000 33793.94000000
## 5 1625918400000 33793.95000000 33943.40000000 33744.40000000 33861.02000000
## 6  1.625922e+12 33858.28000000 33898.17000000 33634.16000000 33700.31000000
##          Volume    Close_time
## 1 1586.69013400 1625907599999
## 2  988.18051900 1625911199999
## 3 1314.38690600 1625914799999
## 4 1674.95679800 1625918399999
## 5 1213.69747000 1625921999999
## 6 1331.15612700 1625925599999</code></pre>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="chapter4.html#cb640-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.numeric</span>(data[,<span class="dv">1</span>]) <span class="co"># check 1st column type is numeric</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="chapter4.html#cb642-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.numeric</span>(data[,<span class="dv">2</span>]) <span class="co"># check 2nd column type is numeric</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="chapter4.html#cb644-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">sapply</span>(data, as.numeric)) <span class="co"># convert all columns to numeric</span></span>
<span id="cb644-2"><a href="chapter4.html#cb644-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data) <span class="co"># good, its double now</span></span></code></pre></div>
<pre><code>##      Open_time     Open     High      Low    Close    Volume   Close_time
## 1 1.625904e+12 33766.01 33950.00 33686.00 33762.79 1586.6901 1.625908e+12
## 2 1.625908e+12 33761.72 33900.00 33711.95 33732.57  988.1805 1.625911e+12
## 3 1.625911e+12 33735.98 33800.00 33599.98 33624.08 1314.3869 1.625915e+12
## 4 1.625915e+12 33624.09 33911.82 33565.00 33793.94 1674.9568 1.625918e+12
## 5 1.625918e+12 33793.95 33943.40 33744.40 33861.02 1213.6975 1.625922e+12
## 6 1.625922e+12 33858.28 33898.17 33634.16 33700.31 1331.1561 1.625926e+12</code></pre>
<p>Final stage is to convert <code>Open_time</code> and <code>Close_time</code> to dates.</p>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="chapter4.html#cb646-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Open_time <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(data<span class="sc">$</span>Open_time<span class="sc">/</span><span class="fl">1e3</span>, <span class="at">origin =</span> <span class="st">&#39;1970-01-01&#39;</span>)</span>
<span id="cb646-2"><a href="chapter4.html#cb646-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Close_time <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(data<span class="sc">$</span>Close_time<span class="sc">/</span><span class="fl">1e3</span>, <span class="at">origin =</span> <span class="st">&#39;1970-01-01&#39;</span>)</span>
<span id="cb646-3"><a href="chapter4.html#cb646-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb646-4"><a href="chapter4.html#cb646-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data) </span></code></pre></div>
<pre><code>##             Open_time     Open     High      Low    Close    Volume
## 1 2021-07-10 11:00:00 33766.01 33950.00 33686.00 33762.79 1586.6901
## 2 2021-07-10 12:00:00 33761.72 33900.00 33711.95 33732.57  988.1805
## 3 2021-07-10 13:00:00 33735.98 33800.00 33599.98 33624.08 1314.3869
## 4 2021-07-10 14:00:00 33624.09 33911.82 33565.00 33793.94 1674.9568
## 5 2021-07-10 15:00:00 33793.95 33943.40 33744.40 33861.02 1213.6975
## 6 2021-07-10 16:00:00 33858.28 33898.17 33634.16 33700.31 1331.1561
##            Close_time
## 1 2021-07-10 11:59:59
## 2 2021-07-10 12:59:59
## 3 2021-07-10 13:59:59
## 4 2021-07-10 14:59:59
## 5 2021-07-10 15:59:59
## 6 2021-07-10 16:59:59</code></pre>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="chapter4.html#cb648-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(data) <span class="co"># check last records</span></span></code></pre></div>
<pre><code>##               Open_time     Open     High      Low    Close    Volume
## 95  2021-07-14 09:00:00 31807.01 31942.35 31754.55 31835.47 1632.8038
## 96  2021-07-14 10:00:00 31829.03 32000.00 31825.56 31920.01 1452.0296
## 97  2021-07-14 11:00:00 31920.01 31996.00 31702.92 31751.48 1637.1042
## 98  2021-07-14 12:00:00 31751.48 32500.00 31550.00 32327.70 5200.5985
## 99  2021-07-14 13:00:00 32330.00 32707.27 32260.83 32427.58 2759.7719
## 100 2021-07-14 14:00:00 32427.59 32562.48 32366.34 32380.93  987.1142
##              Close_time
## 95  2021-07-14 09:59:59
## 96  2021-07-14 10:59:59
## 97  2021-07-14 11:59:59
## 98  2021-07-14 12:59:59
## 99  2021-07-14 13:59:59
## 100 2021-07-14 14:59:59</code></pre>
<hr />
</div>
<div id="chapter46" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> Google Services</h2>
<div id="chapter461" class="section level3" number="4.8.1">
<h3><span class="header-section-number">4.8.1</span> Spreadsheets</h3>
<div class="alert alert-info">
<blockquote>
<p>THIS CHAPTER IS UNDER CONSTRUCTION / Working with Google Spreadsheets need account authorization.</p>
</blockquote>
</div>
<p><code>googlesheets4</code> is a package to work with Google Sheets from R.</p>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="chapter4.html#cb650-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;googlesheets4&quot;)</span></span>
<span id="cb650-2"><a href="chapter4.html#cb650-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(googlesheets4)</span></code></pre></div>
<p>You can read google documents after authentification on google service. There is sample code:</p>
<pre><code>read_sheet(&quot;https://docs.google.com/spreadsheets/d/1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY/edit#gid=780868077&quot;)
gs4_deauth()</code></pre>
<p>Let’s read sample dataset <code>gapminder</code>. It detailed described in next paragraph.</p>
<p>gs4_example(“gapminder”)</p>
<hr />
</div>
<div id="chapter462" class="section level3" number="4.8.2">
<h3><span class="header-section-number">4.8.2</span> Trends</h3>
<p><strong><code>Google Trends</code></strong> is a service for analyzing search requests by many filters like <code>region</code> (continent, country, locality), <code>period</code> (year, month), <code>information category</code> (business, education, hobby, healthcare), <code>information type</code> (news, shopping, video, images) <a href="https://trends.google.com/trends/" class="uri">https://trends.google.com/trends/</a></p>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="chapter4.html#cb652-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&#39;gtrendsR&#39;)</span></span>
<span id="cb652-2"><a href="chapter4.html#cb652-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&#39;ggplot2&#39;)</span></span>
<span id="cb652-3"><a href="chapter4.html#cb652-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtrendsR) <span class="co"># loading package for Google Trends queries</span></span>
<span id="cb652-4"><a href="chapter4.html#cb652-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>Let’s configure out google trends query params</p>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="chapter4.html#cb653-1" aria-hidden="true" tabindex="-1"></a>keywords <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Bitcoin-Kurs&quot;</span>, <span class="st">&quot;FC Barcelona&quot;</span>) <span class="co"># search keywords</span></span>
<span id="cb653-2"><a href="chapter4.html#cb653-2" aria-hidden="true" tabindex="-1"></a>country <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;AT&#39;</span>) <span class="co"># search region from https://support.google.com/business/answer/6270107?hl=en</span></span>
<span id="cb653-3"><a href="chapter4.html#cb653-3" aria-hidden="true" tabindex="-1"></a>time <span class="ot">=</span> (<span class="st">&quot;2021-01-01 2021-05-17&quot;</span>) <span class="co"># period</span></span>
<span id="cb653-4"><a href="chapter4.html#cb653-4" aria-hidden="true" tabindex="-1"></a>channel <span class="ot">=</span> <span class="st">&#39;web&#39;</span> <span class="co"># search channel: google search (&#39;news&#39; - google news, &#39;images&#39; - google images)</span></span></code></pre></div>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="chapter4.html#cb654-1" aria-hidden="true" tabindex="-1"></a><span class="co"># query</span></span>
<span id="cb654-2"><a href="chapter4.html#cb654-2" aria-hidden="true" tabindex="-1"></a>trends <span class="ot">=</span> <span class="fu">gtrends</span>(keywords, <span class="at">gprop =</span> channel, <span class="at">geo =</span> country, <span class="at">time =</span> time, <span class="at">tz =</span> <span class="st">&quot;UTC&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="chapter4.html#cb655-1" aria-hidden="true" tabindex="-1"></a>time_trend <span class="ot">=</span> trends<span class="sc">$</span>interest_over_time</span>
<span id="cb655-2"><a href="chapter4.html#cb655-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(time_trend) <span class="co"># last 6</span></span></code></pre></div>
<pre><code>##         date hits      keyword geo                  time gprop category
## 1 2021-01-01    7 Bitcoin-Kurs  AT 2021-01-01 2021-05-17   web        0
## 2 2021-01-02    0 Bitcoin-Kurs  AT 2021-01-01 2021-05-17   web        0
## 3 2021-01-03    6 Bitcoin-Kurs  AT 2021-01-01 2021-05-17   web        0
## 4 2021-01-04    6 Bitcoin-Kurs  AT 2021-01-01 2021-05-17   web        0
## 5 2021-01-05    0 Bitcoin-Kurs  AT 2021-01-01 2021-05-17   web        0
## 6 2021-01-06    0 Bitcoin-Kurs  AT 2021-01-01 2021-05-17   web        0</code></pre>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="chapter4.html#cb657-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(time_trend) <span class="co"># latest 6</span></span></code></pre></div>
<pre><code>##           date hits      keyword geo                  time gprop category
## 269 2021-05-12   16 FC Barcelona  AT 2021-01-01 2021-05-17   web        0
## 270 2021-05-13    6 FC Barcelona  AT 2021-01-01 2021-05-17   web        0
## 271 2021-05-14    0 FC Barcelona  AT 2021-01-01 2021-05-17   web        0
## 272 2021-05-15    7 FC Barcelona  AT 2021-01-01 2021-05-17   web        0
## 273 2021-05-16   19 FC Barcelona  AT 2021-01-01 2021-05-17   web        0
## 274 2021-05-17   11 FC Barcelona  AT 2021-01-01 2021-05-17   web        0</code></pre>
<p>Let’s visualize query results:</p>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="chapter4.html#cb659-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>time_trend, <span class="fu">aes</span>(<span class="at">x=</span>date, <span class="at">y=</span>hits, <span class="at">group=</span>keyword, <span class="at">col=</span>keyword)) <span class="sc">+</span></span>
<span id="cb659-2"><a href="chapter4.html#cb659-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb659-3"><a href="chapter4.html#cb659-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Time&#39;</span>) <span class="sc">+</span> </span>
<span id="cb659-4"><a href="chapter4.html#cb659-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Relative Interest&#39;</span>) <span class="sc">+</span> </span>
<span id="cb659-5"><a href="chapter4.html#cb659-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>)) <span class="sc">+</span> </span>
<span id="cb659-6"><a href="chapter4.html#cb659-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Google Search Volume&quot;</span>)  </span>
<span id="cb659-7"><a href="chapter4.html#cb659-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb659-8"><a href="chapter4.html#cb659-8" aria-hidden="true" tabindex="-1"></a>plot</span></code></pre></div>
<p><img src="04-chapter4_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<hr />
</div>
</div>
<div id="chapter47" class="section level2" number="4.9">
<h2><span class="header-section-number">4.9</span> SQL (SQLite sample)</h2>
<p>We are going to review working with database on SQLite, becouse it allows us not to install DB-server and start working with simple file.</p>
<p>For now we will use <code>RSQLite</code> package.</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="chapter4.html#cb660-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;RSQLite&quot;)</span></span>
<span id="cb660-2"><a href="chapter4.html#cb660-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSQLite)</span></code></pre></div>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb661-1"><a href="chapter4.html#cb661-1" aria-hidden="true" tabindex="-1"></a><span class="co"># let&#39;s use mtcars data set</span></span>
<span id="cb661-2"><a href="chapter4.html#cb661-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;mtcars&quot;</span>) <span class="co"># loads the data</span></span>
<span id="cb661-3"><a href="chapter4.html#cb661-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars) <span class="co"># preview the data</span></span></code></pre></div>
<pre><code>##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="chapter4.html#cb663-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create new db file</span></span>
<span id="cb663-2"><a href="chapter4.html#cb663-2" aria-hidden="true" tabindex="-1"></a>db_path <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&quot;data/cars_1.sqlite&quot;</span>) <span class="co"># change file name for new create connection</span></span>
<span id="cb663-3"><a href="chapter4.html#cb663-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create connection</span></span>
<span id="cb663-4"><a href="chapter4.html#cb663-4" aria-hidden="true" tabindex="-1"></a>conn <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), </span>
<span id="cb663-5"><a href="chapter4.html#cb663-5" aria-hidden="true" tabindex="-1"></a>                    db_path,</span>
<span id="cb663-6"><a href="chapter4.html#cb663-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">overwrite =</span> <span class="cn">TRUE</span>, <span class="at">append =</span> <span class="cn">FALSE</span>) <span class="co"># for lecture content only</span></span></code></pre></div>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="chapter4.html#cb664-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Write the mtcars dataset into a table names mtcars_data</span></span>
<span id="cb664-2"><a href="chapter4.html#cb664-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dbWriteTable</span>(conn, <span class="st">&quot;cars_table&quot;</span>, mtcars)</span>
<span id="cb664-3"><a href="chapter4.html#cb664-3" aria-hidden="true" tabindex="-1"></a><span class="co"># List all the tables available in the database</span></span>
<span id="cb664-4"><a href="chapter4.html#cb664-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dbListTables</span>(conn)</span></code></pre></div>
<pre><code>## [1] &quot;cars_table&quot;</code></pre>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="chapter4.html#cb666-1" aria-hidden="true" tabindex="-1"></a>table_data <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, <span class="st">&quot;SELECT * FROM cars_table&quot;</span>)</span>
<span id="cb666-2"><a href="chapter4.html#cb666-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(table_data)</span></code></pre></div>
<pre><code>##    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## 1 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## 2 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## 3 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## 4 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## 5 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## 6 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="chapter4.html#cb668-1" aria-hidden="true" tabindex="-1"></a><span class="co"># close connection</span></span>
<span id="cb668-2"><a href="chapter4.html#cb668-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(conn)</span></code></pre></div>
<p>You can write complex queries for many tables if you knowledge of SQL allows.</p>
<hr />
</div>
<div id="web-pages-html" class="section level2" number="4.10">
<h2><span class="header-section-number">4.10</span> Web-pages (HTML)</h2>
<hr />
</div>
<div id="references-1" class="section level2" number="4.11">
<h2><span class="header-section-number">4.11</span> References</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["r-science.pdf"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
