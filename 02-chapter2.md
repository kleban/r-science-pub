# Базові конструкції мови R: типи та структури даних. Частина 1 {#chapter2}

## План {-}

- [Оголошення та ініціалізація змінних](#chapter21)
    - [Поняття змінних та оператор присвоєння](#chapter211)
    - [Правила іменування змінних](#chapter212)
- [Базові типи даних](#chapter22)
    - [Типізація в R](#chapter221)
    - [Перевірка та привдення типів даних](#chapter222)
- [Оператори](#chapter23)
    - [Арифметичні оператори](#chapter231)
    - [Оператори відношення](#chapter232)
    - [Логічні оператори](#chapter233)
- [Корисні математичні функції](#chapter24)
    - [Заокруглення чисел(round, ceiling, floor, trunc, signif)](#chapter241)
    - [Послідовності чисел (seq, rep)](#chapter242)
    - [Генерація псевдовипадкових чисел](#chapter243)
    - [Інші математичні функції та константи R](#chapter244)
    - [Введення-виведння даних](#chapter245)
---

## Оголошення та ініціалізація змінних {#chapter21}

### Поняття змінних та оператор присвоєння {#chapter211}

Базовим поняттям практично усіх мов програмування є **змінна**. Змінна дозволяє записати значення або об'єкт та назвати його для подальшого доступу, зміни, видалення по імені.

Наприклад, присвоєння змінній `my_variable` значення `10` записується так: `my_variable <- 5` або `my_variable = 5`.

Операція надання змінній певного значення у програмуванні називається **присвоєнням**.

_Важливо! Зверніть увагу, що присвоєння (`<-`, `=`) та рівність (`==`) це різні поняття. Оператор `==` здіснює перевірку співпадіння значення двох змінних/об'єктів та повертає результат у вигляді логічного значення `TRUE` (якщо значення рівні) або `FALSE` (якщо значення не рівні)_.

Знак `<-` не є часто використовуваним у різних мовах програмування, зазвичай для присвоєння користуються `=`. Проте в R освновним способом засобом початкової ініціалізації змінних є `<-`.

_Також у програмуванні на R використовуються оператори присвоєння `<<-`, `->`, `->>`. Про них можна прочитати за лыками нижче._

<div class="alert alert-success">
<i class="fas fa-alrt fa-2x fa-link"></i>
 Рекомендую почитати про різницю між операторами присвоєння у R <code>&lt;-</code> та <code>=</code> тут:

 1. [Why do we use arrow as an assignment operator? (Colin FAY)](https://colinfay.me/r-assignment/).
 2. [Difference between assignment operators in R (Ren Kun)](https://renkun.me/2014/01/28/difference-between-assignment-operators-in-r/).
 3. [Assignment Operators](https://stat.ethz.ch/R-manual/R-devel/library/base/html/assignOps.html).
</div>

Приклад:


```r
x <- 45
y <- 10
z <- x + y # z = 45 + 10
z
```

```
## [1] 55
```

Розберемо приклад, описаний вище:

* У першому рядку оголошується змінна `x` і їй присвоюється значення `45`.
* У другому рядку оголошується змінна `y` і їй присвоюється значення `10`.
* У третьому рядку оголошується змінна `z` і їй присвоюється значення суми `x` + `y`. <br>
<small><i>`#` у R використовується як коментар коду, текст написаний після нього ігнорується.</i></small>
* У четвертому рядку відбувається виведення на консоль змінної `z`.

### Правила іменування змінних {#chapter212}

Є кілька основних правил іменування змінних у R:
1. Ім'я змінної може складатися з **букв** [a-z, A-z], **цифр** [0-9], **крапки** `.` та нижнього **підкреслювання** `_`.
2. Ім'я змінної повинно починатися з **букви або крапки**. Якщо воно починається з крапки, то наступним символом повинна бути буква.
3. Не можна використовувати зарезервовані ключові слова мови програмування для іменування змінних, наприклад, `TRUE`/`FALSE`.

Ім'я змінної не може містити пробіл (`space`). Якщо є потреба назвати об'єкт кількома словами, то їх зазвичай розділяють підкресленням `_` або крапкою `.`. Наприклад, змінну можна назвати `my_variable_name` або `my.variable.name`. Назва `myVariableName` ([camel case](https://en.wikipedia.org/wiki/Camel_case)) теж буде коректно сприйнята мовою програмування R, проте такий запис тут вживається не часто.

<span class="text-success">Приклад коректного іменування змінних:</span> `total`, `zminna`, `Sum`, `.length_of_something`, `Number123, x_1`.

<span class="text-danger">Приклад неправильного іменування змінних:</span> `tot@l`, `5x_1`, `_variable`, `FALSE`, `.0ne`.

## Базові типи даних {#chapter22}

### Типізація в R {#chapter221}

Усі мови програмування мають власну типізацію даних з якими працюють. Тип даних - це набір властивостей певних об'єктів та операцій, що можна з ними виконувати. Так, наприклад, з **цілими числами** можна виконувати арифметичні операції додавання, віднімання та інші. Набори символів (простими словами **текст**) зазвичай можуть використовуватися для пошуку у них елементів, редагування (шляхом видалення частини існуючого або додавання нового тексту), склеювання та розділення на частини.

У `R`, на відміну від строго типізованих мов програмування, тип даних визначається на основі поточного значення елемента і може змінюватися у процесі виконання.

Розгялнемо приклад коду з мови програмування `C#` (мова родом із `C`/`Java`):

```csharp
int a = 10;
a = "some text";
```

Подібний код у `C#` передбачає створення нової змінної `a` типу `int` (`integer` - ціле число), а потім відбувається присвоєння для `a` текстового фрагмента (тип `string` у `С#`). Такий код не буде запущено і виникне <span class="text-danger">**помилка компіляції**</span>.

Розглянемо приклад коду з `R`:


```r
a <- 10
a <- "some text"
a
```

```
## [1] "some text"
```

Такий код виконається і на консоль буде виведено `some text`, адже у 1 першому рядку було присвоєно ціле число, у другому - текст. Таким чином `R` має **динамічну типізацію**, що дозволяє у ту ж саму змінну записати значення різних типів. Проте варто пам'ятати, що попереднє значення буде втрачено.

До базових типів даних у R варто віднести:

* Числа з дробовою частиною (`decimal numbers`), як наприклад, `4.0`, `15.214`, що називаються **`numeric(s)`**.
* Натуральні числа (`natural numbers`), як наприклад, `4`, `15`, що називаються **`integer(s)`**.
* Логічні значення (`boolean values`), тобто `TRUE` та `FALSE` (які також можна скорочено записувати `T` та `F`), що називаються **`logical`**.
* Текст або рядки (`string values`), як наприклад, `"Hello"`, `"12 is number"`, що називаються **`character(s)`**.

Оголосимо для прикладу три змінні: `my_numeric` - число, `my_character` - текст, `my_logical` - логічне значення.

```r
my_numeric <- 5
my_character <- "universe"
my_logical <- FALSE
```

Замінимо значення `my_character <- "5"` та спробуємо знайти суму значень:


```r
my_character <- "5"
my_sum <- my_numeric + my_character
```

У результаті виклання даного коду ми отримаємо помилку, адже значення `5` та `"5"` є елементами різних типів даних, перевіримо типи за допомогю функції `class()`:


```r
class(5)
```

```
## [1] "numeric"
```

```r
class("5")
```

```
## [1] "character"
```

Виконання коду `class(5)` показує нам, що `5`є значенням числового типу даних `numeric`, а `class("5")` відповідає тексту `character`, тому арифметична операція додавання між цими значеннями неможлива.

### Перевірка та привдення типів даних {#chapter222}

У випадку коли тип даних потрібно визначити у процесі виконання програми/коду та перетворити значення використовується приведння типів даних.

*Приведення типів даних* - операція перетворення значення з одного типу даних в інший. Важливо памятати, що не завжди приведення типів даних може бути здійснено. Так, наприклад, значення `"5"` (`character`) можна досить просто привести до `5` (`numeric`), проте `"five"` не буде зрозумілим для інтерпритатора.

Для перевірки належності елемента до певного типу даних використовують спеціальну функцію `is.назва_типу(значення)`. Ця функція повертає `TRUE`, якщо елемент належить даному типу і `FALSE`, якщо не належить.

Розглянемо приклад:


```r
my_numeric <- 5
my_character <- "five"
my_logical <- FALSE

is.numeric(my_numeric)
```

```
## [1] TRUE
```

```r
is.character(my_numeric)
```

```
## [1] FALSE
```

Для перетворення типу даних можна скористатися функцією `as.назва_типу(значення)`. У результаті виконання функції буде повернуто значення потрібного типу або пусте значення `NA`, якщо таке приведення не є можливим:


```r
a <- 5
b <- "10"
c <- "10, 20"
as.numeric(b)
```

```
## [1] 10
```

```r
as.numeric(c)
```

```
## Warning: NAs introduced by coercion
```

```
## [1] NA
```

Результат виконання функцій можна записувати у змінні і використовувати у наступних обчисленнях:


```r
a <- 5
b <- "10"
b <- as.numeric(b)
a + b
```

```
## [1] 15
```


```r
number <- as.integer(54)
typeof(number)
```

```
## [1] "integer"
```

```r
class(number)
```

```
## [1] "integer"
```

Повний перелік типів та методів перевірки і приведення їх типів ображений нижче:

| Назва типу | Метод перевірки типу | Метод приведення типу |
|---------|---------|--------|
|Array|is.array|as.array|
|**Character**|is.character|as.character|
|Complex |is.complex |as.complex|
|Dataframe |is.data.frame |as.data.frame|
|**Double** |is.double |as.double|
|Factor |is.factor |as.factor|
|List |is.list| as.list|
|**Logical** |is.logical |as.logical|
|Matrix |is.matrix |as.matrix|
|**Numeric** |is.numeric |as.numeric
|Raw| is.raw| as.raw|
|Time series (ts)| is.ts| as.ts|
|Vector| is.vector |as.vector|

---

## Оператори {#chapter23}

### Арифметичні оператори {#chapter231}

`R` можна використовувати як звичайни калькулятор. 

Розглянемо набір звичних арифметичних операторів, що відомі з початкової школи:
* Додавання: `+`.
* Віднімання: `-`.
* Ділення: `/`.
* Множення: `*`.

А також більш складні оператори:
* Піднесення до степеня: `^` (вводиться з клавіатури як `Shift+6` на ENG-розкладці клавіатури).
* Остача від ділення (ще може називатися "ділення по модулю"): `%%` (вводиться з клавіатури як `Shift+5`).
* Ділення націло: `%/%`.

Розглянемо приклад **додавання** чисел:


```r
5 + 10
```

```
## [1] 15
```


```r
5 + 4 + 15
```

```
## [1] 24
```

```r
5 + 53 + 343
```

```
## [1] 401
```


```r
(5 + 8) + (4 + 9)
```

```
## [1] 26
```

<div class="alert alert-info">
<i class="fas fa-question fa-alert fa-2x"></i> 
_Примітка_. Використання "круглих" дужок у прогрмуванні виразах має пріоритет аналогічний до загальноприйнятих у математиці.</div>

Розглянемо приклад **віднімання** чисел:


```r
47 - 21
```

```
## [1] 26
```


```r
15 - (10 - 25)
```

```
## [1] 30
```

<div class="alert alert-info">
<i class="fas fa-alert fa-2x fa-question"></i> _Примітка_. Заміна знаків до/в "дужках" тут працює так само як працювала у  школі :)
</div>

Приклади **множення** чисел:


```r
5 * 3
```

```
## [1] 15
```


```r
5 * (2 + 5)
```

```
## [1] 35
```

Приклади **ділення** чисел:


```r
12 / 2
```

```
## [1] 6
```


```r
(4 + 7) / 3
```

```
## [1] 3.666667
```

**Піднесення до степеня** за допомогю оператора `^` є досить простим. Так, наприклад, `3^2` дорівнює 9, а `2^3` -  це `2*2*2` і дорівнює 8.  


```r
5^2
```

```
## [1] 25
```


```r
(1+3)^3 + 100 
```

```
## [1] 164
```

**Остача від ділення** дозволяє знайти залишок одного числа від ділення на інше число. 

Наприклад, остача від ділення націло 5 на 2 дорівнює 1, бо `2 * 2 (=4) + 1 = 5`


```r
28 %% 7
```

```
## [1] 0
```


```r
17%%5
```

```
## [1] 2
```

**Ділння націло** залишає лише цілу частину від ідленнядвох чисел:


```r
28 %/% 7
```

```
## [1] 4
```


```r
17 %/% 5 
```

```
## [1] 3
```

```r
Sys.setlocale("LC_CTYPE", "ukrainian")
```

```
## [1] "Ukrainian_Ukraine.1251"
```

```r
# пробіли між цифрами та операторами можна не лишати, це робиться для зручності візуального сприйняття коду
```

<div class="alert alert-info">
В окремих випадках інтерпритатори `R` можуть некоректно читати або взагалі ввжати за помилку наявність кирилиці у коді. Тоді варто вказати явно локалізацію, яку Ви бажаєте використовувати. Для української локалізації варто на початку коду додати рядок: 
```r
Sys.setlocale("LC_CTYPE", "ukrainian")
```
</div>

### Оператори відношення {#chapter232}

**Оператори відношення** відповідають за порівнняння двох об'єктів між собою та повертають значення логічного типу `TRUE`, якщо результат істинний та `FALSE`, якщо результат хибний.

Перелік операторів відношення:

* Більше або дорівнює `>=`.
* Менше `<`.
* Менше або дорівнює `<=`.
* Дорівнює `==`.
* Не дорівнює `!=` 

Для демонстрації принципів роботи операторів відношення оголосимо 3 змінні `a`, `b` та `c`.


```r
a <- 12
b <- 5
c <- 7
```

Розгялнемо кілька прикладів використання описаних вище операторів.

Оператори, що відповідають за первірку на "більше/менше": 



```r
a > b
```

```
## [1] TRUE
```

```r
b + c < a
```

```
## [1] FALSE
```

```r
b + c <= a
```

```
## [1] TRUE
```

Оператори, що відповідають за перевірку на "рівність/нерівність":


```r
a != b
```

```
## [1] TRUE
```

```r
a == b + c
```

```
## [1] TRUE
```

```r
b == c
```

```
## [1] FALSE
```

### Логічні оператори {#chapter233}

До логічних операторів у `R` відносяться:

* І `&` (амперсант, `Shift-7`) - виконання усіх умов одночасно.
* АБО `|` (вертикальна риска, `Shift+\`) - виконання однієї із умов.
* НЕ `!` (знак оклику, `Shift+1`) - заперечення.

Важливо розуміти відмінності між цими операторами вміти використовувати результи їх роботи. Для початку варто розглянути таблицю істинності:

| A | B | Оператор **І** | Оператор **АБО** | Заперечення A (**не A**)|
|---|---|-------|------|-------|
|FALSE|FALSE|FALSE|FALSE|TRUE|
|FALSE|TRUE|FALSE|TRUE|TRUE|
|TRUE|FALSE|FALSE|TRUE|FALSE|
|TRUE|TRUE|TRUE|TRUE|FALSE|

<div class="alert alert-danger">
<i class="fa-2x fas fa-alert fa-battery-quarter"></i>
Матеріали розділу не доповнені прикладами.
</div>

---

## Корисні математичні функції {#chapter24}

### Заокруглення чисел (round, ceiling, floor, trunc, signif) {#chapter241}

Як ми знаємо з математики, що заокруглення чисел буває "вверх", "вниз" або відносно деякого значення, зазвичай пов'язаного із цифрою `5` (`3.6` заокруглюємо до цілого як `4`, а `3.2` як `3`, ввжаючи `3.5` межею).

<div class="alert alert-danger">
<i class="fas fa-alert fa-2x fa-warning"></i>
Увага! Заокрулення чисел у програмуванні може призводити до помилок у результатах  обчислень. Для задач бізнесу або технічних процесів мінімальні відхилення можуть призводити до викривлених результатів або збоїв у системах.
</div>

<i class="far fa-sticky-note"></i> _**Функція `round()`**_

<div class="alert alert-info"><i class="fas fa-2x fa-alert fa-info-circle"></i> &nbsp; Примітка. Тут і надалі функції будуть позначатися як <code>назва()</code> (назва і "круглі" дужки).</div>

Для заокруглення дійних чисел (з дробовою частиною) за правилом `<0.5 & >=0.5` (не знаю як називається науково) використовується функція `round(x, y)`, де `x` - число, `y` - точність (кількість знаків після коми/крапки). Наприклад:


```r
round(3.557, 2)
```

```
## [1] 3.56
```

```r
round(3.241, 2)
```

```
## [1] 3.24
```

```r
round(-3.557, 2)
```

```
## [1] -3.56
```

```r
round(-3.241, 2)
```

```
## [1] -3.24
```

Також можна використати `round(x)` з одним параметром, тоді заокруглення відбудеться до цілої частини, наприклад:


```r
round(124.345)
```

```
## [1] 124
```

<i class="far fa-sticky-note"></i> _**Функція `floor()`**_

Для заокруглення до найближчого меншого цілого числа слід скористатися функцією `floor()`:


```r
floor(3.557)
```

```
## [1] 3
```

```r
floor(3.241)
```

```
## [1] 3
```

```r
floor(-3.557)
```

```
## [1] -4
```

```r
floor(-3.241)
```

```
## [1] -4
```

<i class="far fa-sticky-note"></i> _**Функція `ceiling()`**_

Для заокруглення до найближчого більшого цілого числа слід скористатися функцією `ceiling()`:


```r
ceiling(3.557)
```

```
## [1] 4
```

```r
ceiling(3.241)
```

```
## [1] 4
```

```r
ceiling(-3.557)
```

```
## [1] -3
```

```r
ceiling(-3.241)
```

```
## [1] -3
```

<i class="far fa-sticky-note"></i> _**Функція `trunc()`**_

Функція `trunc()` у R використовується для отримання найбільшого цілого числа, яке більше або рівне `x`. Простими словами це означає, що для чисел менших 0 `(x < 0)` `trunc()` працює як `celing()`, а для чисел більших нуля `x > 0`, як `floor()`:


```r
x <- 5.34
print(paste("trunc:", trunc(x), "celing:", ceiling(x), "floor:", floor(x), sep = " "))
```

```
## [1] "trunc: 5 celing: 6 floor: 5"
```

```r
x <- x * -1
print(paste("trunc:", trunc(x), "celing:", ceiling(x), "floor:", floor(x), sep = " "))
```

```
## [1] "trunc: -5 celing: -5 floor: -6"
```

<i class="far fa-sticky-note"></i> _**Функція `signif()`**_

Інколи виникає потреба заокруглити не десяткову частину числа, а десятки, сотні, тисячі і так далі. Розглядемо варіант, коли у нас є велике число `11 547 741.3` і нам потрібно коротко його записати як `11.5 млн` Для таких задач можна використати функцію `signif(x,y)`, де `x` - число, яке потрібно заокруглити до певного порядку, `y` - порядок заокруглення (рахувати від початку). Наприклад:


```r
big_number <- 11547741.3
rounded_big_number <- signif(big_number,3)
rounded_big_number
```

```
## [1] 11500000
```

```r
rounded_big_number / 1000000
```

```
## [1] 11.5
```

### Послідовності чисел (seq, rep) {#chapter242}

<div class="alert alert-danger">
<i class="fa-2x fas fa-alert fa-battery-quarter"></i>
Матеріали розділу у процесі підготовки.
</div>

### Генерація псевдовипадкових чисел {#chapter243}

<div class="alert alert-danger">
<i class="fa-2x fas fa-alert fa-battery-quarter"></i>
Матеріали розділу у процесі підготовки.
</div>


```r
runif(10)
```

```
##  [1] 0.886498754 0.090903926 0.165796516 0.559961880 0.870694752 0.008559688
##  [7] 0.458639730 0.252696093 0.574020310 0.031568598
```

```r
sample(100)
```

```
##   [1]  77  95  63  55  37  75  60  69  28  13  30  72  31  38  15  58  39  65
##  [19]  92  83  18  36  53  88  71  48  59  43  98  78  32  76  54  41  49  94
##  [37]  84  82  57  66  67  12  14  25  81  62  20  74  19  40  89   4  10  90
##  [55]   1  33  35   3  46 100  50  73   5  80  42  17  85  11  68  47  91  52
##  [73]  51  86  61  70  16  79  87  64  45  97   7  56   2  96  34  26  21  27
##  [91]  93  29   6  44  22   8   9  99  23  24
```

### Інші математичні функції та константи R {#chapter244}

Окрім описаного вище набору функцій `R` містить дуже велику кількість реалізованих функцій з різних сфер науки, бізнесу, техніки тощо. Прочитати про них можна з офіційної документації пакетів, у яких вони реалізовані та знайти за допомогою функції `help()` або `?name`. 

Далі розглянемо перелік найпоширеніших функцій, що використовуються для розв'язання навчальних задач під час вивчення основ програмування.

| Функція | Призначення, опис |
|---------|---------|
|*log(x)*|Логарифм числа *x* за основою *e*|
|*log(x,n)*|Логарифм числа *x* за основою *n*|
|*exp(x)*|*e* у степені *x*|
|*sqrt(x)*|Корінь квадратний числа *x*|
|*factorial(x)*|Факторіал числа *x*|
|*abs(x)*|Модуль числа *x*|

Також у `R` доступні ряд тригонометричних функцій, які вивчалися у школі і не тільки, серед них `cos(x)`, `sin(x)`, `tan(x)`, а також `acos(x)`, `asin(x)`, `atan(x)`, `acosh(x)`, `asinh(x)`, `atanh(x)`.

Детальніше про кожну з них можна почитати у документації за допомогою кодманди `help(function)`.

## Введення-виведння даних {#chapter245}

<div class="alert alert-danger">
<i class="fa-2x fas fa-alert fa-battery-quarter"></i>
Матеріали розділу у процесі підготовки.
</div>



